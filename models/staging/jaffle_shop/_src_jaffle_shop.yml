sources:
  - name: jaffle_shop
    database: jaffle_shop
    schema: raw
    description: "A clone of a Postgres application database"
    config: 
      freshness:
        warn_after:
          count: 6
          period: hour
        error_after:
          count: 12
          period: hour
      loaded_at_field: _etl_loaded_at
    tables:
      - name: jaffle_shop_customers
        description: "Raw customers data"
        freshness: null # override source-level freshness to disable for this table since we dont have any SLAs on it
        columns:
          - name: id
            description: "Primary key for raw customers in the jaffle shop"
            data_tests:
              - unique
              - not_null
          - name: first_name
            description: "Customer first name"
          - name: last_name
            description: "Customer last name"
      - name: jaffle_shop_orders
        description: "Raw orders data"
        columns:
          - name: id
            description: "Primary key for raw orders in the jaffle shop"
            data_tests:
              - unique
              - not_null
          - name: user_id
            description: "Foreign key to the raw customers table"
            data_tests:
              - not_null
              - relationships:
                  field: id
                  to: source('jaffle_shop', 'jaffle_shop_customers')
          - name: order_date
            description: "The date the order was placed"
          - name: order_status
            description: "The status of the order"

        # We can also define source freshness criteria to help us monitor data quality and 
        # reliability. This is entirely optional, but recommended for production projects.
        # For more information, see: https://docs.getdbt.com/docs/building-a-dbt-project/sources/freshness
        # We can have this in sources or m level
        # config: 
        #   freshness:
        #     warn_after:
        #       count: 6
        #       period: hour
        #     error_after:
        #       count: 12
        #       period: hour
        #   loaded_at_field: _etl_loaded_at
