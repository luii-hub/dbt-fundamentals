models:
  - name: stg_stripe__payments
    description: "The grain of payments is one unique payment per row. Each payment is linked to an one or more order_id(s)"
    columns:
      - name: payment_id
        description: "Primary key for payments in Stripe"
        data_tests:
          - unique
          - not_null
      - name: order_id
        description: "Foreign key to the staging orders table"
        data_tests:
          - not_null
          - relationships:
              field: order_id # order_id in staging orders
              to: source('jaffle_shop', 'stg_jaffle_shop__orders')
      - name: payment_method
        description: "The payment method used"
        data_tests:
          - accepted_values:
              values:
                - credit_card
                - bank_transfer
                - coupon
                - gift_card
      - name: payment_status
        description: "The status of the payment"
        data_tests:
          - accepted_values:
              values:
                - success
                - fail
      - name: amount
        description: "The amount paid per payment. Not the total order amount"
      - name: created_at
        description: "The timestamp when the payment was created"
